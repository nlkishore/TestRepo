package com.mycompany.tools;

import org.apache.torque.Torque;
import org.apache.torque.TorqueException;
import org.apache.torque.util.BasePeer;

import java.sql.Connection;

public class TorqueConnectionTest {
    public static void main(String[] args) {
        try {
            Torque.init("src/main/resources/Torque.properties");

            Connection conn = BasePeer.getConnection();
            if (conn != null && !conn.isClosed()) {
                System.out.println("✅ Oracle DB connection established successfully.");
                conn.close();
            } else {
                System.out.println("❌ Connection object is null or closed.");
                System.exit(1);
            }
        } catch (TorqueException te) {
            System.err.println("❌ Torque initialization failed: " + te.getMessage());
            System.exit(2);
        } catch (Exception e) {
            System.err.println("❌ Unexpected error: " + e.getMessage());
            System.exit(3);
        }
    }
}





<build>
  <plugins>
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>exec-maven-plugin</artifactId>
      <version>3.1.0</version>
      <executions>
        <execution>
          <id>db-health-check</id>
          <phase>verify</phase>
          <goals>
            <goal>java</goal>
          </goals>
        </execution>
      </executions>
      <configuration>
        <mainClass>com.mycompany.tools.TorqueConnectionTest</mainClass>
      </configuration>
    </plugin>
  </plugins>
</build>



<profiles>
  <profile>
    <id>db-health-check</id>
    <activation>
      <activeByDefault>false</activeByDefault>
    </activation>
    <build>
      <plugins>
        <plugin>
          <groupId>org.codehaus.mojo</groupId>
          <artifactId>exec-maven-plugin</artifactId>
          <version>3.1.0</version>
          <configuration>
            <mainClass>com.mycompany.tools.TorqueConnectionTest</mainClass>
          </configuration>
        </plugin>
      </plugins>
    </build>
  </profile>
</profiles>


mvn clean verify -Pdb-health-check



mvn exec:java -Pdb-health-check





[DEBUG] Adding project dependency artifact: jackson-datatype-json-org to classpath
[DEBUG] joining on thread Thread[com.mycompany.tools.TorqueConnectionTest.main(),5,com.mycompany.tools.TorqueConnectionTest]
2025-08-28T05:02:40.424061700Z com.mycompany.tools.TorqueConnectionTest.main() ERROR 
javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at java.naming/javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:704)
	at java.naming/javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:305)
	at java.naming/javax.naming.InitialContext.getEnvironment(InitialContext.java:542)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.debugCtx(JndiDataSourceFactory.java:264)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:179)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initialize(JndiDataSourceFactory.java:131)
	at org.apache.torque.TorqueInstance.initDataSourceFactories(TorqueInstance.java:463)
	at org.apache.torque.TorqueInstance.initialize(TorqueInstance.java:166)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:633)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:612)
	at org.apache.torque.Torque.init(Torque.java:139)
	at com.mycompany.tools.TorqueConnectionTest.main(TorqueConnectionTest.java:16)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:279)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-08-28T05:02:40.429054200Z com.mycompany.tools.TorqueConnectionTest.main() ERROR Error reading DataSourceFactory configuration
org.apache.torque.TorqueException: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:184)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initialize(JndiDataSourceFactory.java:131)
	at org.apache.torque.TorqueInstance.initDataSourceFactories(TorqueInstance.java:463)
	at org.apache.torque.TorqueInstance.initialize(TorqueInstance.java:166)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:633)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:612)
	at org.apache.torque.Torque.init(Torque.java:139)
	at com.mycompany.tools.TorqueConnectionTest.main(TorqueConnectionTest.java:16)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:279)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at java.naming/javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:704)
	at java.naming/javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:305)
	at java.naming/javax.naming.InitialContext.getEnvironment(InitialContext.java:542)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.debugCtx(JndiDataSourceFactory.java:264)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:179)
	... 9 more
 Torque initialization failed: org.apache.torque.TorqueException: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial




******************

2025-08-28T07:40:01.402505400Z com.mycompany.tools.TorqueConnectionTest.main() ERROR 
javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at java.naming/javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:704)
	at java.naming/javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:305)
	at java.naming/javax.naming.InitialContext.getEnvironment(InitialContext.java:542)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.debugCtx(JndiDataSourceFactory.java:264)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:179)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initialize(JndiDataSourceFactory.java:131)
	at org.apache.torque.TorqueInstance.initDataSourceFactories(TorqueInstance.java:463)
	at org.apache.torque.TorqueInstance.initialize(TorqueInstance.java:166)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:633)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:612)
	at org.apache.torque.Torque.init(Torque.java:139)
	at com.mycompany.tools.TorqueConnectionTest.main(TorqueConnectionTest.java:16)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:279)
	at java.base/java.lang.Thread.run(Thread.java:842)
 Torque initialization failed: org.apache.torque.TorqueException: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
2025-08-28T07:40:01.405507300Z com.mycompany.tools.TorqueConnectionTest.main() ERROR Error reading DataSourceFactory configuration
org.apache.torque.TorqueException: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:184)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initialize(JndiDataSourceFactory.java:131)
	at org.apache.torque.TorqueInstance.initDataSourceFactories(TorqueInstance.java:463)
	at org.apache.torque.TorqueInstance.initialize(TorqueInstance.java:166)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:633)
	at org.apache.torque.TorqueInstance.init(TorqueInstance.java:612)
	at org.apache.torque.Torque.init(Torque.java:139)
	at com.mycompany.tools.TorqueConnectionTest.main(TorqueConnectionTest.java:16)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:279)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or in an application resource file: java.naming.factory.initial
	at java.naming/javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:704)
	at java.naming/javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:305)
	at java.naming/javax.naming.InitialContext.getEnvironment(InitialContext.java:542)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.debugCtx(JndiDataSourceFactory.java:264)
	at org.apache.torque.dsfactory.JndiDataSourceFactory.initJNDI(JndiDataSourceFactory.java:179)
	... 9 more


